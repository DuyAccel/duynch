


[{"content":"","date":"8 tháng 1 2026","externalUrl":null,"permalink":"/","section":"","summary":"","title":"","type":"page"},{"content":"","date":"8 tháng 1 2026","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":" Nguyễn Châu Hiếu Duy # ","date":"8 tháng 1 2026","externalUrl":null,"permalink":"/about/","section":"","summary":"","title":"About me","type":"page"},{"content":"","date":"1 tháng 9 2024","externalUrl":null,"permalink":"/tags/ci/cd/","section":"Tags","summary":"","title":"CI/CD","type":"tags"},{"content":"","date":"1 tháng 9 2024","externalUrl":null,"permalink":"/tags/docker/","section":"Tags","summary":"","title":"Docker","type":"tags"},{"content":"","date":"1 tháng 9 2024","externalUrl":null,"permalink":"/tags/portfolio/","section":"Tags","summary":"","title":"Portfolio","type":"tags"},{"content":"","date":"1 tháng 9 2024","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"ps: website hồi đó mình làm đã bị đập đi xây lại thành như bây giờ nha :D\nKhông còn lo về câu nói \u0026ldquo;Máy tui nó chạy bình thường mà\u0026rdquo;. Trong bài viết này, tôi sẽ chia cách mà bản thân đã tạo và publish một website trên một AWS EC2 instance mộ cách hoàn toàn tự động và miễn phí. Tại khoảnh khắc bạn push code lên github repository, website sẽ được tự động build và triển khai lên production. :D\nCác công nghệ được sử dụng # Docker - dùng để đóng gói container code. Github Action - cho CD pipeline. Hugo + Hugo-profile theme - build website bằng README.md quá đã. AWS EC2 - dùng để host website thành phẩm. Không cần phải nói thì Docker gần như đã trở thành một tiêu chuẩn trong giới lập trình viên trong những năm gần đây. Còn về công cụ CI/CD, mặc dù đã từng setup và sử dụng jenkins một thời gian nhưng nó khá phức tạp và tốn nhiều tài nguyên. Vậy nên, lần này tôi lựa chọn Github Action với hơn 2000 phút chạy miễn phí mỗi tháng cho 1 dự án cá nhân thì quá là dư rồi. Tiếp theo là Hugo, một công cụ cho phép build, dựng những trang web tĩnh bằng các file markdown, quá là thân thiện với dân low-dev. Tranh thủ khoảng thời gian 1 năm trial của AWS account, tôi sẽ host sản phẩm của mình lên đó.\nXây dựng website nào # Install Hugo # Tôi sẽ dùng prebuilt binary của Hugo, bạn cũng có thể dễ dàng tải nó từ hugo release page. Một lưu ý là phải download phiên bản extended để có thể sử dụng các theme của Hugo. Sau đây là các command tôi dùng để tải và sử dụng Hugo.\nmkdir ~/hugo-install cd ~/hugo-install wget https://github.com/gohugoio/hugo/releases/download/v0.133.1/hugo_extended_0.133.1_linux-amd64.tar.gz tar -xzf hugo_extended_0.133.1_linux-amd64.tar.gz chmod +x hugo # Use root permission to copy hugo binary file to PATH folder. sudo cp hugo /usr/local/bin/ Create hugo website and select theme # You can follow Hugo guide to learn how to build your website. My theme is hugo-profile if you interest.\nIf you are developing inside a container (like me), remember to re-bind the ip address to 0.0.0.0. So that, your hugo website can be accessed via host bind port:\nhugo server --bind 0.0.0.0 Create docker image # After finish your website, lets containerize it with docker. Because using hugo development webservice is not recommend in production, I will nginx. Remember to move your hugo-install folder into your workspace because we need to use hugo binary file. Don\u0026rsquo;t worry about image size since we can use docker multi-stage to copy only necesary files.\n# Build stage. FROM alpine:3.20.2 AS builder # Install needed dependencies for hugo. RUN apk update \u0026amp;\u0026amp; \\ apk add --no-cache gcompat libstdc++ WORKDIR /app # Copy source code to image (change ./devel to your folder). COPY ./devel . # Install hugo. RUN cd hugo-install \u0026amp;\u0026amp; \\ tar -xzf hugo_extended_0.133.0_linux-amd64.tar.gz \u0026amp;\u0026amp; \\ chmod +x hugo \u0026amp;\u0026amp; \\ mv hugo /bin/ # Clear old build. Then, rebuild website. RUN rm -rf public \u0026amp;\u0026amp; \\ hugo # Production stage. FROM nginx:1.27.1-alpine # Copy necesary files from build stage COPY --from=builder /app/public /usr/share/nginx/html EXPOSE 80 CMD [\u0026#34;nginx\u0026#34;, \u0026#34;-g\u0026#34;, \u0026#34;daemon off;\u0026#34;] Setting CD pipeline # In order to use Github Action, you need to create .github/workflows folder in root project (same folder with .git). Then, create a .yml file in .github/workflows. Our pipline consist of 4 main steps:\nDownload source code from repository. Build image from source. Push image into docker hub. SSH into server, pull image and run container. This is my CD.yml contain pipeline of those steps:\nname: Create and publish a Docker image on: push: branches: [\u0026#39;main\u0026#39;] workflow_dispatch: env: REGISTRY: docker.io USER_NAME: duyaccel IMAGE_NAME: duyaccel/personal-web SSH_KEY: ${{ secrets.SSH_KEY }} SERVER: ${{ secrets.SERVER }} SV_USER: ${{ secrets.SV_USER }} jobs: continuous_deployment: runs-on: ubuntu-latest permissions: contents: read packages: write attestations: write id-token: write steps: - name: Checkout repository uses: actions/checkout@v4 with: submodules: \u0026#39;true\u0026#39; - name: Log in to the Container registry uses: docker/login-action@65b78e6e13532edd9afa3aa52ac7964289d1a9c1 with: registry: ${{ env.REGISTRY }} username: ${{ env.USER_NAME }} password: ${{ secrets.DOCKER_TOKEN }} - name: Extract metadata (tags, labels) for Docker id: meta uses: docker/metadata-action@9ec57ed1fcdbf14dcef7dfbe97b2010124a938b7 with: images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }} - name: Build and push Docker image id: push uses: docker/build-push-action@f2a1d5e99d037542a71f64918e516c093c6f3fc4 with: context: . push: true tags: ${{ steps.meta.outputs.tags }} labels: ${{ steps.meta.outputs.labels }} - name: Deploy website run: | echo \u0026#34;$SSH_KEY\u0026#34; \u0026gt; private_key \u0026amp;\u0026amp; chmod 600 private_key ssh -o StrictHostKeyChecking=no -i private_key ${SV_USER}@${SERVER} \u0026#39; docker rm -f portfolio || true docker image prune -af docker run -d --name portfolio -p 80:80 duyaccel/personal-web:main \u0026#39; If you wonder what is:\n${{ secrets.DOCKER_TOKEN }} SSH_KEY: ${{ secrets.SSH_KEY }} SERVER: ${{ secrets.SERVER }} SV_USER: ${{ secrets.SV_USER }} The answer is github secrets, we will need to add them to github repository before execute pipeline. Go to your repository -\u0026gt; Settings -\u0026gt; Security -\u0026gt; Secrets and variables -\u0026gt; Actions to add new secrets. What we need for this workflow are:\nDOCKER_TOKEN: token to sign in docker accout (create in your docker account setting). SSH_KEY: private key to SSH connect to your host. SERVER: host ip address. SV_USER: username of the host. Execute pipeline # Having .github/workflows/CD.yml, you just need to push code to your repository and wait for it to be executed. We can view the progress in Actions tab of the repository. If nothing went wrong, you can find your website on your web browser by searching ip address/domain name. You can also ssh into host to check if your containers are working properly. Conclusion # In this post, I introduced the way I create an continuos deployment pipeline for my portfolio website using Github Action. Though it is accessable from internet, the security warnings are really annoying. In the future, I will add SSL certificate for my website via something like reverse proxy to manage more webservices. Do you looking forward to it? By the way, thanks for reading, see you in next posts.\nReferences:\nhttps://gohugo.io/documentation https://docs.github.com/en/Actions ","date":"1 tháng 9 2024","externalUrl":null,"permalink":"/posts/website-with-cd-pipeline/","section":"Posts","summary":"","title":"Tự động triển khai website với CD pipeline","type":"posts"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]